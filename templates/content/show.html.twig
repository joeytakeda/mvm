{% extends 'base.html.twig' %}

{% block title %}{{ content.firstLine }}{% endblock %}

{% block admin %}
{% include 'partial/toolbar.html.twig' with {'edit': 'content_edit', 'delete': 'content_delete', 'id': content.id } %}
{% endblock %}

{% block breadcrumb %}
    {% include 'partial/breadcrumb.html.twig' with {'index': 'content', 'show': content.firstLine} %}
{% endblock %}

 {% block pageheader %}
    <h1><span class="firstLine">{{ content.firstLine }}</span></h1>
 {% endblock %}

{% block body %}

{% set details %}

<div class="content-details">
    <table class="table table-condensed">
        <tbody>
            <tr>
                <th>First Line</th>
                <td>{{ content.firstLine }}</td>
            </tr>
            {% if content.date is not null %}
            <tr>
                <th>Date</th>
                <td>{{ content.date }}</td>
            </tr>
            {% endif %}
            <tr>
                <th>Description</th>
                <td>{{ content.description|raw }}</td>
            </tr>
            {% if isAdmin %}
            <tr>
                <th>Created</th>
                <td>{% if content.created %}{{ content.created|date }}{% endif %}</td>
            </tr>
            <tr>
                <th>Updated</th>
                <td>{% if content.updated %}{{ content.updated|date }}{% endif %}</td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>
<div class="transcription">
    <h4>Transcription</h4>
    <div class="transcription-body">
        {% if content.transcription is not empty %}
        {{ content.transcription | raw }}
        {% else %}
        <p>No transcription available.</p>
        {% endif %}
    </div>

</div>
{% endset %}

{% set contributions %}
{% if isAdmin %}
{% include 'partial/toolbar.html.twig' with {'edit': 'content_contributions', 'id': content.id} %}
{% endif %}

{% if content.contributions|length > 0 %}

{% set processNotes = content.contributions|filter(c => c.note is not empty)|length > 0  %}
<table class="table">
    <thead>
        <tr>
            <th>Contributor</th>
            <th>Role</th>
            {% if processNotes %}
                <th>Note</th>
            {% endif %}
        </tr>
    </thead>
    {% for contribution in content.contributions %}
    <tr>
        <td><a href="{{ path('person_show', {'id': contribution.person.id}) }}">{{ contribution.person }}</a></td>
        <td><a href="{{ path('content_role_show', {'id': contribution.role.id}) }}">{{ contribution.role }}</a></td>
        {% if processNotes %}
        <td>
            {{ contribution.note|raw }}
        </td>
        {% endif %}
    </tr>
    {% endfor %}
</table>
{% endif %}
{% endset %}

{% set manuscripts %}
{% if content.manuscriptContents|length > 0 %}
<div class="gallery">
    {% for manuscriptContent in content.manuscriptContents %}
    {% include 'manuscript/partial/gallery-item.html.twig' with {'manuscript': manuscriptContent.manuscript, 'callbackDescription': manuscriptContent.context} %}
    {% endfor %}
    <div class="item empty"><!--Keep open--></div>
</div>
{% endif %}
{% endset %}

{% set tabs = {
'Transcription &amp; Details': details,
'Contributors': contributions,
'Manuscripts': manuscripts
} %}


{% include 'partial/tabs.html.twig' with {'tabs': tabs} %}

{% endblock %}
